Extract:
  provider: aws 
  params:
    $type: sql
    output_location: s3://your-bucket/output
    database: dev_gold
    query: |  
      SELECT p.*, r.*
      FROM fact_social_media_reaction_post r
      JOIN dim_post_details p
      WHERE r.created_at >= CURRENT_TIMESTAMP - INTERVAL '1' DAY
      AND p.updated_at >= CURRENT_TIMESTAMP - INTERVAL '1' DAY
      
Transform:
  response_format: sentiment
  api_base: ${OPENAI_API_BASE}
  api_key: ${OPENAI_API_KEY}

Load:
  provider: aws
  params:
    $type: file
    output_location: s3://your-bucket/output
    format: parquet
